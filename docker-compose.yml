services:
  nanodns:
    image: iyuangang/nanodns:latest
    container_name: nanodns
    restart: unless-stopped
    ports:
      - "53:53/udp"
    volumes:
      - ./nanodns.json:/etc/nanodns/nanodns.json:ro
    # Grant permission to bind port 53 without running as root
    cap_add:
      - NET_BIND_SERVICE
    # Read-only root filesystem (security hardening)
    read_only: true
    tmpfs:
      - /tmp
    # Resource limits
    deploy:
      resources:
        limits:
          cpus: "0.5"
          memory: 64M
